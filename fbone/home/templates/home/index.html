{% extends "layouts/front_base.html" %}
{% from "macros/_form.html" import render_form %}
{% from 'macros/_misc.html' import render_pagination_v3 %}

{% block body %}
    <div class="container">
        <div class="row">
            <div class="col-lg-9 col-md-9 col-sm-12">
                <div class="row">
                    <div class="panel panel-danger">
                        <div class="panel-heading">
                            <b>Truyện mới cập nhật </b>
                        </div>
                        <div class="panel-body">
                            {% for item in top_new %}
                                <div class="col-lg-2 col-md-3 col-sm-4">
                                    <a href="{{ url_for('home.HomeView:detail', slug=item.slug) }}">
                                        <div class="row">
                                            <div class="col-lg-11 col-md-11 col-sm-11 top_new_item">
                                                <div class="row">
                                                    <img src="{{ item.img }}" width="100%" height="100%"
                                                         alt="{{ item.name }}">
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <b>{{ item.name | trim_text }}</b> <br>
                                                        {{ item.updated_time | prettydate }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <b>Truyện đọc nhiều</b>
                        </div>
                        <div class="panel-body">
                            {% for item in top_read %}
                                <a href="{{ url_for('home.HomeView:detail', slug=item.slug) }}">
                                    <div class="col-lg-2 col-md-3 col-sm-4">
                                        <div class="row">
                                            <div class="col-lg-11 col-md-11 col-sm-11 top_read_item">
                                                <div class="row">
                                                    <img src="{{ item.img }}" width="100%" height="100%">
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <b>{{ item.name | trim_text }}</b> <br>
                                                        {{ item.read_count }} views
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                {# List all categoried #}
                <div class="row">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <b>Tất cả các thể loại</b>
                        </div>
                        <div class="panel-body">
                            {% for category in categories %}
                                <div class="col-lg-3 col-md-4 col-sm-6">
                                    <a href="{{ url_for('category.TopCategoryView:index', slug=category.slug) }}"><span
                                            class="glyphicon glyphicon-align-left"></span> {{ category.name }}({{ category.mangas | length }})</a>
                                </div>

                            {% endfor %}
                        </div>
                    </div>
                </div>

                {% for item in list_alpha %}
                    {% if item.value %}
                        <div class="row">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <span class="glyphicon glyphicon-book"></span> {{ item.key | capitalize }}
                                </div>
                                <div class="panel-body">
                                    {% for m in item.value %}
                                        <div class="col-lg-4 col-md-4 col-sm-6">
                                            <a href="{{ url_for('home.HomeView:detail', slug=m.slug) }}">{{ m.name }}</a>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}

                <div class="row">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <b>Truyện đã hoàn thành </b>
                        </div>
                        <div class="panel-body">
                            {% for item in completed %}
                                <div class="col-lg-2 col-md-3 col-sm-4">
                                    <a href="{{ url_for('home.HomeView:detail', slug=item.slug) }}">
                                        <div class="row">
                                            <div class="col-lg-11 col-md-11 col-sm-11 top_new_item">
                                                <div class="row">
                                                    <img src="{{ item.img }}" width="100%" height="100%"
                                                         alt="{{ item.name }}">
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <b>{{ item.name | trim_text }}</b> <br>
                                                        {{ item.updated_time | prettydate }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                {# List all mangas
                <div class="row">
                    <table class="table table-hover table-bordered">
                        <thead>
                        <th>Tên truyện</th>
                        <th>Lượt xem</th>
                        <th>Ngày đăng</th>
                        </thead>
                        <tbody>
                        {% for item in mangas.items %}
                            <tr>
                                <td>{{ item.name }}</td>
                                <td>{{ item.read_count }}</td>
                                <td>{{ item.created_at | display_time }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <button class="btn btn-success">Xem tất cả truyện</button>
                    {% if mangas and mangas.pages > 0 %}
                        {{ render_pagination_v3(mangas, 'home.HomeView:index') }}
                    {% endif %}
                </div>
                #}
            </div>

            <div class="col-lg-3 col-md-3 col-sm-12">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="panel panel-default">
                            <div class="panel-heading"><b>Chương mới</b></div>
                            <div class="panel-body">
                                {% for item in top_chapter %}
                                    <div class="row">
                                        <div class="col-lg-9 col-md-9 col-sm-9">
                                            <a><span class="glyphicon glyphicon-stats"></span> {{ item.name }} <br></a>
                                        </div>
                                        <div class="col-lg-3 col-md-3 col-sm-3">
                                            <div class="row">
                                                <p style="color: #ff0000">{{ item.created_at | chapter_time }}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <hr class="chapter_new">
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>


    </div>
{% endblock %}

{% block js_user %}
    <script src="{{ url_for('static', filename='js/home/main.js') }}"></script>
{% endblock %}
