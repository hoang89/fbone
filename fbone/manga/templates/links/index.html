{% extends "layouts/base.html" %}
{% from 'macros/_misc.html' import render_pagination %}
{% from "macros/_form.html" import render_form %}
{% block body %}
    <div class="container-fluid">
        <div class="row">
            <form method="get" action="{{ request.url }}">
                <div class="span12">
                    <div class="span3">
                        <input type="name" name="key_word" placeholder="Manga name" class="input-medium" id="key_word"
                               value="{{ key_word }}">
                    </div>
                    <div class="span3">
                        <select name="filter" id="filter">
                            {% for i in ['name', 'created_at', 'modified_at'] %}
                                {% if i == filter %}
                                    <option value="{{ i }}" selected="true">{{ i | capitalize }}</option>
                                {% else %}
                                    <option value="{{ i }}">{{ i | capitalize }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                    <div class="span3">
                        <button class="btn btn-success" type="submit">Filter apply</button>
                    </div>
            </form>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span12">
            <table class="table table-bordered">
                <thead>
                <th>Name</th>
                {# <th>Link</th>  #}
                <th>Desc</th>
                <th>Img</th>
                <th>Action</th>
                </thead>
                <tbody>
                {% for item in paginates.items %}
                    <tr>
                        <td><a href="{{ url_for('manga.MangaLinkView:detail', id=item.id) }}">{{ item.name }}</a>
                        </td>
                        {# <td><a href="{{ item.link }}">{{ item.link }}</a></td>  #}
                        <td>{{ item.desc|safe }}</td>
                        <td><img src="{{ item.img }}" width="100%" height="100%"></td>
                        {% if not item.chapters %}
                            <td>
                                <a href="{{ url_for('manga.MangaLinkView:all_chapter', id=item.id, back=request.url) }}">Init
                                    Chapter</a></td>
                        {% else %}
                            <td>{{ item.chapters|length }} chapters</td>
                        {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="widget-foot">
        {% if paginates and paginates.pages > 0 %}
            {{ render_pagination(paginates, 'manga.MangaLinkView:index') }}
        {% endif %}
    </div>
    </div>
{% endblock %}
